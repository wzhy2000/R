/* gls_test.cpp  -	Test data
 *
 *	Copyright (C) 2011 THe Center for Statistical Genetics
 *  http://statgen.psu.edu
 */

#include "fm_matrix.h"
#include "fm_vector.h"
#include "gls_test.h"

void proc_gls_simu_geno_test( CFmMatrix* pSnps)
{
    double pp[20][10]={
        { 0,   1,  -1,   0,  -1,  -1,   0,   0,  -1,    0 },
        { 0,   0,   0,   1,   0,   0,   0,  -1,   0,    1 },
        { 1,   0,   0,  -1,  -1,   1,   0,   0,   0,   -1 },
        { 0,   0,   0,   0,   0,  -1,   0,   1,   0,    0 },
        { 0,   1,   1,   0,  -1,   1,   0,   0,   0,    1 },
        { 0,   1,   1,   1,   0,   0,   0,   0,  -1,    1 },
        { 0,   0,   1,  -1,   0,   0,  -1,   0,   0,    0 },
        {-1,   1,  -1,  -1,  -1,  -1,   0,  -1,   0,    1 },
        { 1,  -1,   0,   0,   1,   0,   0,  -1,   0,    1 },
        { 0,   0,   1,   0,  -1,   0,   1,   0,   0,    0 },
        {-1,  -1,   1,   1,   0,   0,   0,   1,   0,    0 },
        { 1,   1,   1,  -1,   1,   1,   0,   1,   0,    0 },
        { 1,   1,   1,   1,   0,   0,   0,   0,   0,    0 },
        {-1,   0,  -1,   0,   1,   0,  -1,   0,  -1,    0 },
        {-1,   0,   0,   1,   1,   0,   0,   1,   1,    0 },
        { 0,   1,   0,  -1,   1,   0,   0,   0,   0,   -1 },
        { 1,   0,   0,  -1,  -1,   0,  -1,   0,   1,    1 },
        {-1,   0,   0,   1,   0,  -1,   0,   1,   1,    1 },
        {-1,   0,   0,   1,   0,   1,   0,   0,   1,    0 },
        { 1,   0,   0,  -1,  -1,   0,   0,   1,   1,    0 }};

    for (int i=0;i<20;i++)
    {
        char szBuf[20]={0};
        sprintf(szBuf, "Snp%d", i);
        pSnps->SetRow(i, pp[i], szBuf);
    }
}

void proc_gls_simu_pheno_test( CFmMatrix* pPhenoY,
                           CFmMatrix* pPhenoZ,
                           CFmMatrix* pCovarX,
                           CFmVector* pZRange)
{
    double dbPhenoY[10][8]= {
        {30.27660, 42.56258, 50.08134, 47.50242, 38.52074, 35.38807, 33.37084,  0.00000},
        {42.42376, 30.92205, 32.47681, 38.87012, 34.75199, 37.90313, 31.97705,  0.00000},
        {45.52869, 34.55985, 38.44111, 41.88645, 41.35025,  0.00000,  0.00000,  0.00000},
        {29.04553, 41.86809, 33.44638, 31.10505, 14.94586,  0.00000,  0.00000,  0.00000},
        {35.11460, 38.03917, 31.59364, 35.74776, 28.50299, 32.28793, 22.97015,  0.00000},
        {45.61292, 31.79354, 36.90944, 37.76535, 41.98024, 43.76038,  0.00000,  0.00000},
        {38.07885, 48.34850, 43.87335, 36.38166, 37.19204, 43.64560, 38.94289,  0.00000},
        {29.64142, 49.52997, 38.83060, 31.42566, 30.77597, 30.76906, 33.73464, 19.57758},
        {35.79510, 39.67668, 31.97221, 30.84217, 22.37495,  0.00000,  0.00000,  0.00000},
        {42.82938, 35.80351, 42.21055, 35.54617, 38.73300, 34.38782,  0.00000,  0.00000}};

    for (int i=0;i<10;i++)
    {
        char szBuf[20]={0};
        sprintf(szBuf, "Id%d", i);
        pPhenoY->SetRow(i, dbPhenoY[i], szBuf);
    }

    double dbCovarZ[10][8]= {
        {31,   34,   42,   47,   68,   71,   75,    0},
        {31,   34,   45,   46,   52,   53,   66,    0},
        {35,   44,   47,   56,   79,    0,    0,    0},
        {34,   41,   55,   58,   79,    0,    0,    0},
        {30,   49,   52,   59,   64,   69,   73,    0},
        {39,   61,   66,   70,   76,   77,    0,    0},
        {38,   48,   55,   67,   69,   70,   73,    0},
        {30,   48,   56,   64,   69,   70,   73,   75},
        {35,   38,   51,   68,   73,    0,    0,    0},
        {43,   46,   58,   64,   73,   76,    0,    0}};

    for (int i=0;i<10;i++)
    {
        char szBuf[20]={0};
        sprintf(szBuf, "Id%d", i);
        pPhenoZ->SetRow(i, dbCovarZ[i], szBuf);
    }

    double dbCovarX[10]={2, 1, 1, 1, 1, 1, 2, 2, 1, 1 };
    for (int i=0;i<10;i++)
    {
        pCovarX->Set(i, 0, dbCovarX[i]);
    }

}

